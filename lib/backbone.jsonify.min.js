(function(o,e){if("function"==typeof define&&define.amd)define(["backbone","underscore"],e);else if("object"==typeof module&&module.exports){var i=require("backbone"),t=require("underscore");module.exports=e(i,t)}else e(o.Backbone,o._)})(this,function(o,e){"use strict";o.Jsonify={},o.Jsonify.VERSION="0.2.0",o.Jsonify.exToJSON=o.Model.prototype.toJSON;var i=function(t,n){return e.each(t,function(s,c){s instanceof o.Model||s instanceof o.Collection?t[c]=s.toJSON({deepJson:n}):e.isObject(s)&&n&&(t[c]=i(e.clone(s),n))}),t};o.Model.prototype.exToJSON=o.Jsonify.exToJSON,o.Model.prototype.toJSON=e.wrap(o.Jsonify.exToJSON,function(o){var t=arguments[1];t||(t={});var n;return e.isBoolean(t.omit)&&t.omit||e.isBoolean(t.pick)&&!t.pick?{}:(n=e.isBoolean(t.pick)&&t.pick||e.isBoolean(t.omit)&&!t.omit?o.call(this,t):t.pick?e.pick(this.attributes,t.pick):t.omit?e.omit(this.attributes,t.omit):o.call(this,t),n=i(n,t.deepJson))})});