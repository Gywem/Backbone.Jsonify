(function(e,o){if("function"==typeof define&&define.amd)define(["backbone","underscore"],o);else if("object"==typeof module&&module.exports){var n=require("backbone"),t=require("underscore");module.exports=o(n,t)}else o(e.Backbone,e._)})(this,function(e,o){"use strict";e.Jsonify={},e.Jsonify.VERSION="0.1.0";var n=e.Model.prototype.toJSON,t=function(n){return o.each(n,function(i,r){i instanceof e.Model||i instanceof e.Collection?n[r]=i.toJSON():o.isObject(i)&&(n[r]=t(o.clone(i)))}),n};e.Model.prototype.exToJSON=n,e.Model.prototype.toJSON=o.wrap(n,function(e){var n,i=arguments[1];return i&&i.includeInJson?n=o.pick(this.attributes,i.includeInJson):i&&i.excludeInJson?n=o.omit(this.attributes,i.excludeInJson):i&&i.filterInJson?(n={},o.each(this.attributes,function(e,o){i.filterInJson(e,o)&&(n[o]=e)})):n=e.call(this,i),n=t(n)})});