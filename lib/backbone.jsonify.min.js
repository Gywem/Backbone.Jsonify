(function(e,n){if("function"==typeof define&&define.amd)define(["backbone","underscore"],n);else if("object"==typeof module&&module.exports){var t=require("backbone"),o=require("underscore");module.exports=n(t,o)}else n(e.Backbone,e._)})(this,function(e,n){"use strict";e.Jsonify.VERSION="0.1.0";var t=e.Model.prototype.toJSON,o=function(t){return n.each(t,function(i,c){i instanceof e.Model||i instanceof e.Collection?t[c]=i.toJSON():n.isObject(i)&&(t[c]=o(n.clone(i)))}),t};e.Model.prototype.toJSON=function(){var e,i=arguments[0];return i&&i.includeInJson?e=n.pick(this.attributes,i.includeInJson):i&&i.excludeInJson?e=n.omit(this.attributes,i.excludeInJson):i&&i.filterInJson?(e={},n.each(this.attributes,function(n,t){i.filterInJson(n,t)&&(e[t]=n)})):e=t.call(this,i),e=o(e)}});