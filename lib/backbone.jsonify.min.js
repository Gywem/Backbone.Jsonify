(function(e,o){if("function"==typeof define&&define.amd)define(["backbone","underscore"],o);else if("object"==typeof module&&module.exports){var t=require("backbone"),n=require("underscore");module.exports=o(t,n)}else o(e.Backbone,e._)})(this,function(e,o){"use strict";e.Jsonify.VERSION="0.1.0";var t=e.Model.prototype.toJSON,n=function(t){return o.each(t,function(i,r){i instanceof e.Model||i instanceof e.Collection?t[r]=i.toJSON():o.isObject(i)&&(t[r]=n(o.clone(i)))}),t};e.Model.prototype.exToJSON=t,e.Model.prototype.toJSON=o.wrap(t,function(e){var t,i=arguments[1];return i&&i.includeInJson?t=o.pick(this.attributes,i.includeInJson):i&&i.excludeInJson?t=o.omit(this.attributes,i.excludeInJson):i&&i.filterInJson?(t={},o.each(this.attributes,function(e,o){i.filterInJson(e,o)&&(t[o]=e)})):t=e.call(this,i),t=n(t)})});