(function(e,o){if("function"==typeof define&&define.amd)define(["backbone","underscore"],o);else if("object"==typeof module&&module.exports){var n=require("backbone"),t=require("underscore");module.exports=o(n,t)}else o(e.Backbone,e._)})(this,function(e,o){"use strict";e.Jsonify={},e.Jsonify.VERSION="0.2.0";var n=e.Model.prototype.toJSON,t=function(n){return o.each(n,function(i,c){i instanceof e.Model||i instanceof e.Collection?n[c]=i.toJSON():o.isObject(i)&&(n[c]=t(o.clone(i)))}),n};e.Model.prototype.exToJSON=n,e.Model.prototype.toJSON=o.wrap(n,function(e){var n,i=arguments[1];return n=i&&i.includeInJson?o.pick(this.attributes,i.includeInJson):i&&i.excludeInJson?o.omit(this.attributes,i.excludeInJson):e.call(this,i),n=t(n)})});